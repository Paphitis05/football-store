<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Items to Order</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header>
        <h1>Add Items to Order #{{ order.Order_ID }}</h1>
    </header>
    <nav>
        <a href="/">Home</a>
        <a href="/data_entry">Data Entry</a>
    </nav>
    <main>
        <p><strong>Order Code:</strong> {{ order.order_code }}</p>
        <p><strong>Customer:</strong> {{ order.Customer_Name }}</p>

        <hr>

        <h2>Items in this Order</h2>
        {% if order_items %}
            <table>
                <thead>
                    <tr>
                        <th>Item Name</th>
                        <th>Original Price</th>
                        <th>Discount</th>
                        <th>Discounted Price</th>
                        <th>Quantity</th>
                        <th>Subtotal</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in order_items %}
                    <tr>
                        <td>{{ item.name }}</td>
                        <td>{{ "%.2f"|format(item.price) }}</td>
                        <td>{{ "%d%%"|format(item.discount_percent * 100) }}</td>
                        <td>{{ "%.2f"|format(item.discounted_price) }}</td>
                        <td>{{ item.quantity }}</td>
                        <td>{{ "%.2f"|format(item.subtotal) }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="5" style="text-align:right; font-weight:bold;">Total Order Price:</td>
                        <td style="font-weight:bold;">{{ "%.2f"|format(total_price) }}</td>
                    </tr>
                </tfoot>
            </table>
        {% else %}
            <p>No items have been added to this order yet.</p>
        {% endif %}

        <hr>

        <h2>Add Item to Order</h2>
        <form action="{{ url_for('add_item_to_order_action', order_id=order.Order_ID) }}" method="post">
            <label for="item_id">Item:</label>
            <select name="item_id" id="item_id" required>
                {% for item in items %}
                    <option value="{{ item.item_id }}">{{ item.name }} (Price: {{ "%.2f"|format(item.price) }})</option>
                {% endfor %}
            </select><br>

            <label for="quantity">Quantity:</label>
            <input type="number" id="quantity" name="quantity" min="1" value="1" required><br>

            <button type="submit">Add Item</button>
        </form>
    </main>
</body>
</html>
